---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/PostLayout.astro';
import { Image } from 'astro:assets';
import crown from '../../assets/img/logos/logo-crown.png'

export async function getStaticPaths() {
  const blogEntries = await getCollection('blog');
  return blogEntries.map(post => ({
    params: { slug: post.slug }, props: { post },
  }));
}

const allPosts = await getCollection("blog");
const { post } = Astro.props;
const { Content } = await post.render();
---

<Layout title={post.data.title} description={post.data.description} image={post.data.imageUrl}>
    <div class="container-fluid px-0 pt-3">
        <div class="row row-cols-1 min-vh-500 position-relative">
            <!-- <img class="position-absolute top-0 start-0 z-0 w-100 h-100 object-fit" src={post.data.imageUrl} alt={post.data.description}/> -->
            <div class="col d-flex flex-column justify-content-center align-items-center text-center p-5">
                <Image class="mb-3" style="width: 80px; height: 80px" src={crown} alt="Prince Collection logo"/>
                <nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
                    <ol class="breadcrumb">
                      <li class="breadcrumb-item"><a class="text-pc-dark" href="/blog">Blog</a></li>
                      <li class="breadcrumb-item text-pc active" aria-current="page">{post.data.title}</li>
                    </ol>
                  </nav>
                <h1 class="display-4 fw-bold lh-1 mb-3">{post.data.title}</h1>
                <p class="h4 mb-2">{post.data.description}</p>
                <!-- tags -->
                <div class="d-flex justify-content center-align-items-center py-2">
                    {
                        post.data.tags.map((tag) =>(
                        <span class="badge text-bg-secondary me-1 mb-2">{tag}</span>
                        ))
                    }
                </div>
                <p class="text-pc-dark fw-bold">By: {post.data.author}</p>
            </div>
            <div class="col d-flex flex-column justify-content-center align-items-center min-vh-50 pt-5">
                <Image class="w-100 h-100 object-fit shadow" width="700" height="500" src={post.data.imageUrl} alt="Prince Collection logo"/>
            </div>
        </div>
    </div>
    <!-- body -->
    <div id="" class="container w-100 mx-auto">
        <div class="row p-4">
            <div class="d-none d-lg-flex flex-column col-md-2 col-lg-3 pt-5">
                <h2 class="text-secondary">Related posts</h2>
                {
                    allPosts.map((post) => (
                        <div class="card rounded-5 mb-3">
                            <img src={post.data.imageUrl} class="card-img-top rounded-5 p-2" style="width: 100%; height: 150px; object-fit: cover" alt="...">
                            <div class="card-body px-4 pb-4">
                                <p class="small mb-2">{post.data.pubDate.toString().slice(0,10)}</p>
                                <h5 class="card-title fw-bold text-secondary">{post.data.title}</h5>
                                <p class="card-text">{post.data.description}</p>
                                <a href={`/blog/${post.slug}/`}>
                                    <button class="btn btn-pc btn-sm px-4 rounded-3">Read</button>
                                </a>
                            </div>
                        </div>
                    ))
                }
            </div>
            <div id="content" class="col-md-12 col-lg-9 p-5">
                <Content />
            </div>
        </div>
    </div>
</Layout>
<!-- 
<style>
    #content h1, .content h1 {
    background: red;
    margin: 30px 0;
}

</style> -->